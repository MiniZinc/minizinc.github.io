<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.6. Automatic Solution Checking, Model Validation, and Benchmarking &mdash; The MiniZinc Handbook 2.8.2</title>
      <link rel="stylesheet" type="text/css" href="static/pygments.css?v=77553476" />
      <link rel="stylesheet" type="text/css" href="static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="static/style.css?v=572cde19" />

  
    <link rel="canonical" href="http://www.minizinc.org/doc-latest/en/checkers.html"/>
  <!--[if lt IE 9]>
    <script src="static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="static/jquery.js?v=5d32c60e"></script>
        <script src="static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="static/documentation_options.js?v=a2a062bf"></script>
        <script src="static/doctools.js?v=888ff710"></script>
        <script src="static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="static/js/doc-links.js?v=34cd1aa9"></script>
    <script src="static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3.7. Globalizer" href="globalizer.html" />
    <link rel="prev" title="3.5. Solving Technologies and Solver Backends" href="solvers.html" />
    <link rel="apple-touch-icon" sizes="57x57" href="static/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="static/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="static/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="static/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="static/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="static/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="static/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="static/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="static/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="static/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="static/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="static/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="static/favicon/favicon-16x16.png">
    <link rel="manifest" href="static/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="static/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  <a href="https://www.minizinc.org">
    
      <img src="static/MiniZn_logo_2.svg" class="logo" alt="Logo"/>
  </a>
      <div class="version">
        2.8.2
      </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  
    
  
  <a href="index.html" class="reference internal icon icon-home"> The MiniZinc Handbook </a>
  
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="part_1_overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="part_2_tutorial.html">2. Minizinc 指南</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="part_3_user_manual.html">3. User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="command_line.html">3.1. The MiniZinc Command Line Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="minizinc_ide.html">3.2. The MiniZinc IDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualisation.html">3.3. Visualising solutions in the MiniZinc IDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpprofiler.html">3.4. CP-Profiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="solvers.html">3.5. Solving Technologies and Solver Backends</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.6. Automatic Solution Checking, Model Validation, and Benchmarking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#autonomous-automatic-solution-checking-and-benchmarking">3.6.1. Autonomous Automatic Solution Checking and Benchmarking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#model-validation-automatic-solution-checking-with-a-checker-model">3.6.2. Model Validation: Automatic Solution Checking with a Checker Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#basic-checker-models">3.6.2.1. Basic checker models</a></li>
<li class="toctree-l4"><a class="reference internal" href="#detailed-feedback">3.6.2.2. Detailed feedback</a></li>
<li class="toctree-l4"><a class="reference internal" href="#instance-data-in-checker-models">3.6.2.3. Instance data in checker models</a></li>
<li class="toctree-l4"><a class="reference internal" href="#checking-optimisation-problems">3.6.2.4. Checking optimisation problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hidden-variables">3.6.2.5. Hidden variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="globalizer.html">3.7. Globalizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="find_mus.html">3.8. FindMUS</a></li>
<li class="toctree-l2"><a class="reference internal" href="mzn-analyse.html">3.9. Mzn-Analyse</a></li>
<li class="toctree-l2"><a class="reference internal" href="jupyter.html">3.10. Using MiniZinc in Jupyter Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html">3.11. Python Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="javascript.html">3.12. JavaScript Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation_detailed.html">3.13. Installation from Source Code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="part_4_reference.html">4. Reference Manual</a></li>
</ul>

  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">The MiniZinc Handbook</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="part_3_user_manual.html"><span class="section-number">3. </span>User Manual</a></li>
      <li class="breadcrumb-item active"><span class="section-number">3.6. </span>Automatic Solution Checking, Model Validation, and Benchmarking</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="automatic-solution-checking-model-validation-and-benchmarking">
<span id="ch-solution-checkers"></span><h1><span class="section-number">3.6. </span>Automatic Solution Checking, Model Validation, and Benchmarking<a class="headerlink" href="#automatic-solution-checking-model-validation-and-benchmarking" title="Link to this heading"></a></h1>
<p>MiniZinc supports checking the correctness of solutions of a model in two ways.
First, it is the <em>autonomous checking</em> where compiler substitutes solution values into the model
and tries to find inconsistencies, possibly invoking a solver to a much smaller instance.
Second, it is by using a <em>checker model</em>. This latter method can also be seen as model validation.</p>
<section id="autonomous-automatic-solution-checking-and-benchmarking">
<h2><span class="section-number">3.6.1. </span>Autonomous Automatic Solution Checking and Benchmarking<a class="headerlink" href="#autonomous-automatic-solution-checking-and-benchmarking" title="Link to this heading"></a></h2>
<p>For this method, compiler needs the values of as many variables as possible,
ideally all variables without the right-hand side. For all top-level variables (not those inside let constructs)
the values can be output using <tt class="docutils literal">--output-mode dzn</tt> compiler option. For optimization problems, when no explicit
objective variable exists, a variable named <tt class="docutils literal">_objective</tt> is added by <tt class="docutils literal">--output-objective</tt>.
Then, each produced solution can be copied into a <tt class="docutils literal">.dzn</tt> and compiled together with the original instance,
adding <tt class="docutils literal">--allow-multiple-assignments</tt> option if <tt class="docutils literal">--output-objective</tt> was used. In the case that
some variables inside let constructs need to be assigned, a solver has to be invoked for the
smaller instance remaining after fixing the supplied values. For example, for the following model:</p>
<div class="highlight-minizinc notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">a</span><span class="p">;</span>
<span class="kt">var</span><span class="s"> </span><span class="kt">float</span><span class="p">:</span><span class="s"> </span><span class="nv">b</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="nv">a</span><span class="p">;</span>
<span class="k">solve</span>
<span class="s">  </span><span class="k">maximize</span><span class="s"> </span><span class="nv">a</span><span class="o">-</span><span class="nv">b</span><span class="p">;</span>
<span class="k">output</span>
<span class="s">  </span><span class="p">[</span><span class="s"> &quot;a+b is </span><span class="p">\(</span><span class="nv">a</span><span class="o">+</span><span class="nv">b</span><span class="p">)</span><span class="se">\n</span><span class="s">&quot; </span><span class="p">];</span>
</pre></div>
</div>
<p>running it with <tt class="docutils literal">minizinc --solver gecode test_output_mode.mzn --output-mode dzn --output-objective</tt> ignores
the provided output annotation and prints</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>a = -2147483646;
_objective = 0.0;
----------
==========
</pre></div>
</div>
<p>which can be added as an extra <tt class="docutils literal">.dzn</tt> file. The process of compilation for autonomous checking and re-solving
with the output variables fixed,
is automated by a Python script <tt class="docutils literal">tests/benchmarking/mzn-test.py</tt>. To solve an instance with autonomous
checking by variable value substitution, run, e.g.,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mzn-test.py<span class="w"> </span>--solver<span class="w"> </span>gecode<span class="w"> </span>model.mzn<span class="w"> </span>data.dzn
</pre></div>
</div>
<p>Moreover, <tt class="docutils literal">mzn-test.py</tt> provides facility to run a list of instances and compare results
from various test runs and different solvers.</p>
</section>
<section id="model-validation-automatic-solution-checking-with-a-checker-model">
<h2><span class="section-number">3.6.2. </span>Model Validation: Automatic Solution Checking with a Checker Model<a class="headerlink" href="#model-validation-automatic-solution-checking-with-a-checker-model" title="Link to this heading"></a></h2>
<p>This approach has two main applications:</p>
<ul class="simple">
<li><p>Instructors can provide checker models for student assignments. This provides students with immediate, detailed feedback on their modelling attempts.</p></li>
<li><p>A simplified checker model can be used to verify a complex model used for solving. This can be useful when experimenting with new decompositions of constraints, or for post-processing solutions if some constraints cannot be added to the original model (e.g. in case the solver does not support certain constructs).</p></li>
</ul>
<p>Running MiniZinc with solution checking is easy. On the command line, simply pass the name of the checker model in addition to the problem model:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>minizinc<span class="w"> </span>model.mzn<span class="w"> </span>model.mzc.mzn<span class="w"> </span>data.dzn
</pre></div>
</div>
<p>Checker models can be pre-compiled in order to obfuscate their contents (e.g. if they contain clues to students how to model the problem):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>minizinc<span class="w"> </span>--compile-solution-checker<span class="w"> </span>model.mzc.mzn
</pre></div>
</div>
<p>This will create the compiled checker model <tt class="docutils literal">model.mzc</tt>, which can be used instead of the clear text version for checking:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>minizinc<span class="w"> </span>model.mzn<span class="w"> </span>model.mzc<span class="w"> </span>data.dzn
</pre></div>
</div>
<p>The MiniZinc IDE has built-in support for solution checkers. Whenever the current project contains a file with the same file name as the current model but file extension <tt class="docutils literal">.mzc</tt> or <tt class="docutils literal">.mzc.mzn</tt>, the “Run” button turns into a “Run+Check” button.</p>
<p>The rest of this section describes how to implement checker models.</p>
<section id="basic-checker-models">
<h3><span class="section-number">3.6.2.1. </span>Basic checker models<a class="headerlink" href="#basic-checker-models" title="Link to this heading"></a></h3>
<p>At its core, a checker model takes each solution that a solver produces as input, and outputs whether the solution is correct or not. Let’s use the simple map colouring model from the tutorial as an example. Here is the model again:</p>
<div class="literal-block-wrapper docutils container" id="ex-aust-2">
<div class="code-block-caption"><span class="caption-number">Listing 3.6.1 </span><span class="caption-text">A MiniZinc model <a class="reference download internal" download="" href="downloads/3e6f50094af0528c5e587cfa94af9247/aust.mzn"><tt class="xref download docutils literal">aust.mzn</tt></a> for colouring the states and territories in Australia <span class="mzn-playground-button"><a href="playground-aust-checker.html" target="_blank" title="Open in Playground">&#9654;</a></span></span><a class="headerlink" href="#ex-aust-2" title="Link to this code"></a></div>
<div class="highlight-minizinc notranslate"><div class="highlight"><pre><span></span><span class="c">% Colouring Australia using nc colours</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">nc</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">3</span><span class="p">;</span>

<span class="kt">var</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">nc</span><span class="p">:</span><span class="s"> </span><span class="nv">wa</span><span class="p">;</span><span class="s">   </span><span class="kt">var</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">nc</span><span class="p">:</span><span class="s"> </span><span class="nv">nt</span><span class="p">;</span><span class="s">  </span><span class="kt">var</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">nc</span><span class="p">:</span><span class="s"> </span><span class="nv">sa</span><span class="p">;</span><span class="s">   </span><span class="kt">var</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">nc</span><span class="p">:</span><span class="s"> </span><span class="nv">q</span><span class="p">;</span>
<span class="kt">var</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">nc</span><span class="p">:</span><span class="s"> </span><span class="nv">nsw</span><span class="p">;</span><span class="s">  </span><span class="kt">var</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">nc</span><span class="p">:</span><span class="s"> </span><span class="nv">v</span><span class="p">;</span><span class="s">   </span><span class="kt">var</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">nc</span><span class="p">:</span><span class="s"> </span><span class="nv">t</span><span class="p">;</span>

<span class="k">constraint</span><span class="s"> </span><span class="nv">wa</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">nt</span><span class="p">;</span>
<span class="k">constraint</span><span class="s"> </span><span class="nv">wa</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">sa</span><span class="p">;</span>
<span class="k">constraint</span><span class="s"> </span><span class="nv">nt</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">sa</span><span class="p">;</span>
<span class="k">constraint</span><span class="s"> </span><span class="nv">nt</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">q</span><span class="p">;</span>
<span class="k">constraint</span><span class="s"> </span><span class="nv">sa</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">q</span><span class="p">;</span>
<span class="k">constraint</span><span class="s"> </span><span class="nv">sa</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">nsw</span><span class="p">;</span>
<span class="k">constraint</span><span class="s"> </span><span class="nv">sa</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">v</span><span class="p">;</span>
<span class="k">constraint</span><span class="s"> </span><span class="nv">q</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">nsw</span><span class="p">;</span>
<span class="k">constraint</span><span class="s"> </span><span class="nv">nsw</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">v</span><span class="p">;</span>
<span class="k">solve</span><span class="s"> </span><span class="k">satisfy</span><span class="p">;</span>

<span class="k">output</span><span class="s"> </span><span class="p">[</span><span class="s">&quot;wa=</span><span class="p">\(</span><span class="nv">wa</span><span class="p">)</span><span class="se">\t</span><span class="s"> nt=</span><span class="p">\(</span><span class="nv">nt</span><span class="p">)</span><span class="se">\t</span><span class="s"> sa=</span><span class="p">\(</span><span class="nv">sa</span><span class="p">)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="s">        &quot;q=</span><span class="p">\(</span><span class="nv">q</span><span class="p">)</span><span class="se">\t</span><span class="s"> nsw=</span><span class="p">\(</span><span class="nv">nsw</span><span class="p">)</span><span class="se">\t</span><span class="s"> v=</span><span class="p">\(</span><span class="nv">v</span><span class="p">)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="s">         &quot;t=&quot;</span><span class="p">,</span><span class="s"> </span><span class="nb">show</span><span class="p">(</span><span class="nv">t</span><span class="p">),</span><span class="s">  &quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">];</span>
</pre></div>
</div>
</div>
<p>A checker model for this model requires the values of the variables <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">wa</span></code>, <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">nt</span></code>, and so on, for each solution, and then has to test whether all constraints hold. The output of the checker model should contain a line starting with <tt class="docutils literal">CORRECT</tt> if the solution passes the test, or <tt class="docutils literal">INCORRECT</tt> if it doesn’t.</p>
<p>Since these values will be fixed in any solution, checker models simply declare parameters with the same name as the model variables:</p>
<div class="literal-block-wrapper docutils container" id="ex-aust-check">
<div class="code-block-caption"><span class="caption-number">Listing 3.6.2 </span><span class="caption-text">A MiniZinc checker model <a class="reference download internal" download="" href="downloads/47e27911bd47dea2ebd2488ab7818015/aust.mzc.mzn"><tt class="xref download docutils literal">aust.mzc.mzn</tt></a> for the map colouring problem <span class="mzn-playground-button"><a href="playground-aust-checker.html" target="_blank" title="Open in Playground">&#9654;</a></span></span><a class="headerlink" href="#ex-aust-check" title="Link to this code"></a></div>
<div class="highlight-minizinc notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">wa</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">nt</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">sa</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">q</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">nsw</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">v</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">t</span><span class="p">;</span>

<span class="k">output</span><span class="s"> </span><span class="p">[</span>
<span class="s">  </span><span class="k">if</span><span class="s"> </span><span class="nv">wa</span><span class="o">!=</span><span class="nv">nt</span><span class="s"> </span><span class="o">/\</span><span class="s"> </span><span class="nv">wa</span><span class="o">!=</span><span class="nv">sa</span><span class="s"> </span><span class="o">/\</span><span class="s"> </span><span class="nv">nt</span><span class="o">!=</span><span class="nv">sa</span><span class="s"> </span><span class="o">/\</span><span class="s"> </span><span class="nv">nt</span><span class="o">!=</span><span class="nv">q</span><span class="s"> </span><span class="o">/\</span><span class="s"> </span><span class="nv">sa</span><span class="o">!=</span><span class="nv">q</span><span class="s"> </span><span class="o">/\</span>
<span class="s">     </span><span class="nv">sa</span><span class="o">!=</span><span class="nv">nsw</span><span class="s"> </span><span class="o">/\</span><span class="s"> </span><span class="nv">sa</span><span class="o">!=</span><span class="nv">v</span><span class="s"> </span><span class="o">/\</span><span class="s"> </span><span class="nv">q</span><span class="o">!=</span><span class="nv">nsw</span><span class="s"> </span><span class="o">/\</span><span class="s"> </span><span class="nv">nsw</span><span class="o">!=</span><span class="nv">v</span>
<span class="s">  </span><span class="k">then</span><span class="s"> &quot;CORRECT</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="s">  </span><span class="k">else</span><span class="s"> &quot;INCORRECT</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="s">  </span><span class="k">endif</span>
<span class="p">];</span>
</pre></div>
</div>
</div>
<p>Running the model and the checker will produce output like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>wa=3   nt=2    sa=1
q=3    nsw=2   v=3
t=3
% Solution checker report:
% CORRECT
----------
</pre></div>
</div>
<p>The solution checker report is embedded as comments in the original output.</p>
</section>
<section id="detailed-feedback">
<h3><span class="section-number">3.6.2.2. </span>Detailed feedback<a class="headerlink" href="#detailed-feedback" title="Link to this heading"></a></h3>
<p>The basic checker model above only reports whether the solutions satisfy the constraints, but it doesn’t provide any insights into the nature of the error if a constraint is violated.</p>
<p>We can use standard MiniZinc functionality to provide much more detailed feedback. The following checker model introduces a helper function <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">check</span></code> which outputs a detailed error message if a constraint doesn’t hold. The results of all the checks are combined, and if any of the constraints was violated, the output is <tt class="docutils literal">INCORRECT</tt>, otherwise it is <tt class="docutils literal">CORRECT</tt>.</p>
<div class="literal-block-wrapper docutils container" id="ex-aust-check-2">
<div class="code-block-caption"><span class="caption-number">Listing 3.6.3 </span><span class="caption-text">A checker model <a class="reference download internal" download="" href="downloads/bdbe3aa5c45ea88004c3127300c88d67/aust-2.mzc.mzn"><tt class="xref download docutils literal">aust-2.mzc.mzn</tt></a> for the map colouring problem with more detailed error messages <span class="mzn-playground-button"><a href="playground-aust-checker-2.html" target="_blank" title="Open in Playground">&#9654;</a></span></span><a class="headerlink" href="#ex-aust-check-2" title="Link to this code"></a></div>
<div class="highlight-minizinc notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">wa</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">nt</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">sa</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">q</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">nsw</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">v</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">t</span><span class="p">;</span>

<span class="k">test</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="kt">bool</span><span class="p">:</span><span class="s"> </span><span class="nv">b</span><span class="p">,</span><span class="kt">string</span><span class="p">:</span><span class="s"> </span><span class="nv">s</span><span class="p">)</span><span class="s"> </span><span class="o">=</span>
<span class="s">  </span><span class="k">if</span><span class="s"> </span><span class="nv">b</span><span class="s"> </span><span class="k">then</span><span class="s"> </span><span class="l">true</span><span class="s"> </span><span class="k">else</span><span class="s"> </span><span class="nf">trace_stdout</span><span class="p">(</span><span class="s">&quot;ERROR: &quot;</span><span class="o">++</span><span class="nv">s</span><span class="o">++</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="l">false</span><span class="p">)</span><span class="s"> </span><span class="k">endif</span><span class="p">;</span>

<span class="k">output</span><span class="s"> </span><span class="p">[</span>
<span class="s">  </span><span class="k">if</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="nv">wa</span><span class="o">!=</span><span class="nv">nt</span><span class="p">,</span><span class="s"> &quot;wa and nt have the same colour&quot;</span><span class="p">)</span>
<span class="s">  </span><span class="o">/\</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="nv">wa</span><span class="o">!=</span><span class="nv">sa</span><span class="p">,</span><span class="s"> &quot;wa and sa have the same colour&quot;</span><span class="p">)</span>
<span class="s">  </span><span class="o">/\</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="nv">nt</span><span class="o">!=</span><span class="nv">sa</span><span class="p">,</span><span class="s"> &quot;nt and sa have the same colour&quot;</span><span class="p">)</span>
<span class="s">  </span><span class="o">/\</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="nv">nt</span><span class="o">!=</span><span class="nv">q</span><span class="p">,</span><span class="s"> &quot;nt and q have the same colour&quot;</span><span class="p">)</span>
<span class="s">  </span><span class="o">/\</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="nv">sa</span><span class="o">!=</span><span class="nv">q</span><span class="p">,</span><span class="s"> &quot;sa and q have the same colour&quot;</span><span class="p">)</span>
<span class="s">  </span><span class="o">/\</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="nv">sa</span><span class="o">!=</span><span class="nv">nsw</span><span class="p">,</span><span class="s"> &quot;sa and nsw have the same colour&quot;</span><span class="p">)</span>
<span class="s">  </span><span class="o">/\</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="nv">sa</span><span class="o">!=</span><span class="nv">v</span><span class="p">,</span><span class="s"> &quot;sa and v have the same colour&quot;</span><span class="p">)</span>
<span class="s">  </span><span class="o">/\</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="nv">q</span><span class="o">!=</span><span class="nv">nsw</span><span class="p">,</span><span class="s"> &quot;q and nsw have the same colour&quot;</span><span class="p">)</span>
<span class="s">  </span><span class="o">/\</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="nv">nsw</span><span class="o">!=</span><span class="nv">v</span><span class="p">,</span><span class="s"> &quot;nsw and v have the same colour&quot;</span><span class="p">)</span>
<span class="s">  </span><span class="k">then</span><span class="s"> &quot;CORRECT: all constraints hold.</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="s">  </span><span class="k">else</span><span class="s"> &quot;INCORRECT</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="s">  </span><span class="k">endif</span>
<span class="p">];</span>
</pre></div>
</div>
</div>
<p>However, the checker model will only report the first violated constraint, since the conjunction operator short-circuits the evaluation when one of its arguments is false. For example, if we remove all constraints from the original model, the output would be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>wa=3   nt=3    sa=3
q=3    nsw=3   v=3
t=3
% Solution checker report:
% ERROR: wa and nt have the same colour
% INCORRECT
----------
</pre></div>
</div>
<p>In order to get all error messages, we can force the evaluation of all checkers by creating an auxiliary array of check results:</p>
<div class="literal-block-wrapper docutils container" id="ex-aust-check-3">
<div class="code-block-caption"><span class="caption-number">Listing 3.6.4 </span><span class="caption-text">A checker model <a class="reference download internal" download="" href="downloads/088eecaeee5a2838a42b1da9fc729117/aust-3.mzc.mzn"><tt class="xref download docutils literal">aust-3.mzc.mzn</tt></a> for the map colouring problem without short-circuit evaluation <span class="mzn-playground-button"><a href="playground-aust-checker-3.html" target="_blank" title="Open in Playground">&#9654;</a></span></span><a class="headerlink" href="#ex-aust-check-3" title="Link to this code"></a></div>
<div class="highlight-minizinc notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">wa</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">nt</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">sa</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">q</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">nsw</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">v</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">t</span><span class="p">;</span>

<span class="k">test</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="kt">bool</span><span class="p">:</span><span class="s"> </span><span class="nv">b</span><span class="p">,</span><span class="kt">string</span><span class="p">:</span><span class="s"> </span><span class="nv">s</span><span class="p">)</span><span class="s"> </span><span class="o">=</span>
<span class="s">  </span><span class="k">if</span><span class="s"> </span><span class="nv">b</span><span class="s"> </span><span class="k">then</span><span class="s"> </span><span class="l">true</span><span class="s"> </span><span class="k">else</span><span class="s"> </span><span class="nf">trace_stdout</span><span class="p">(</span><span class="s">&quot;ERROR: &quot;</span><span class="o">++</span><span class="nv">s</span><span class="o">++</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="l">false</span><span class="p">)</span><span class="s"> </span><span class="k">endif</span><span class="p">;</span>

<span class="kt">array</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">bool</span><span class="p">:</span><span class="s"> </span><span class="nv">checks</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="p">[</span>
<span class="s">  </span><span class="nf">check</span><span class="p">(</span><span class="nv">wa</span><span class="o">!=</span><span class="nv">nt</span><span class="p">,</span><span class="s"> &quot;wa and nt have the same colour&quot;</span><span class="p">),</span>
<span class="s">  </span><span class="nf">check</span><span class="p">(</span><span class="nv">wa</span><span class="o">!=</span><span class="nv">sa</span><span class="p">,</span><span class="s"> &quot;wa and sa have the same colour&quot;</span><span class="p">),</span>
<span class="s">  </span><span class="nf">check</span><span class="p">(</span><span class="nv">nt</span><span class="o">!=</span><span class="nv">sa</span><span class="p">,</span><span class="s"> &quot;nt and sa have the same colour&quot;</span><span class="p">),</span>
<span class="s">  </span><span class="nf">check</span><span class="p">(</span><span class="nv">nt</span><span class="o">!=</span><span class="nv">q</span><span class="p">,</span><span class="s"> &quot;nt and q have the same colour&quot;</span><span class="p">),</span>
<span class="s">  </span><span class="nf">check</span><span class="p">(</span><span class="nv">sa</span><span class="o">!=</span><span class="nv">q</span><span class="p">,</span><span class="s"> &quot;sa and q have the same colour&quot;</span><span class="p">),</span>
<span class="s">  </span><span class="nf">check</span><span class="p">(</span><span class="nv">sa</span><span class="o">!=</span><span class="nv">nsw</span><span class="p">,</span><span class="s"> &quot;sa and nsw have the same colour&quot;</span><span class="p">),</span>
<span class="s">  </span><span class="nf">check</span><span class="p">(</span><span class="nv">sa</span><span class="o">!=</span><span class="nv">v</span><span class="p">,</span><span class="s"> &quot;sa and v have the same colour&quot;</span><span class="p">),</span>
<span class="s">  </span><span class="nf">check</span><span class="p">(</span><span class="nv">q</span><span class="o">!=</span><span class="nv">nsw</span><span class="p">,</span><span class="s"> &quot;q and nsw have the same colour&quot;</span><span class="p">),</span>
<span class="s">  </span><span class="nf">check</span><span class="p">(</span><span class="nv">nsw</span><span class="o">!=</span><span class="nv">v</span><span class="p">,</span><span class="s"> &quot;nsw and v have the same colour&quot;</span><span class="p">)</span>
<span class="p">];</span>

<span class="k">output</span><span class="s"> </span><span class="p">[</span>
<span class="s">  </span><span class="k">if</span><span class="s"> </span><span class="k">forall</span><span class="p">(</span><span class="nv">checks</span><span class="p">)</span>
<span class="s">  </span><span class="k">then</span><span class="s"> &quot;CORRECT: all constraints hold.</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="s">  </span><span class="k">else</span><span class="s"> &quot;INCORRECT</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="s">  </span><span class="k">endif</span>
<span class="p">];</span>
</pre></div>
</div>
</div>
<p>Now the output contains all error messages (for the case where the model has no constraints):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>wa=3   nt=3    sa=3
q=3    nsw=3   v=3
t=3
% Solution checker report:
% ERROR: nsw and v have the same colour
% ERROR: q and nsw have the same colour
% ERROR: sa and v have the same colour
% ERROR: sa and nsw have the same colour
% ERROR: sa and q have the same colour
% ERROR: nt and q have the same colour
% ERROR: nt and sa have the same colour
% ERROR: wa and sa have the same colour
% ERROR: wa and nt have the same colour
% INCORRECT
----------
</pre></div>
</div>
</section>
<section id="instance-data-in-checker-models">
<h3><span class="section-number">3.6.2.3. </span>Instance data in checker models<a class="headerlink" href="#instance-data-in-checker-models" title="Link to this heading"></a></h3>
<p>The map colouring example was quite simple because the model did not contain any parameter declarations. For a model that is parameterised, the checker model simply contains the same parameter declarations. MiniZinc will then pass the actual parameters of the instance being solved to the checker model.</p>
<p>For example, the following checker model could be used for the <em>n</em>-Queens problem.</p>
<div class="literal-block-wrapper docutils container" id="ex-nqueens-check">
<div class="code-block-caption"><span class="caption-number">Listing 3.6.5 </span><span class="caption-text">A checker model <a class="reference download internal" download="" href="downloads/a250d1c353c7bfc91c5e3794ab9c53a3/nqueens.mzc.mzn"><tt class="xref download docutils literal">nqueens.mzc.mzn</tt></a> for the n-Queens problem <span class="mzn-playground-button"><a href="playground-nqueens-checker.html" target="_blank" title="Open in Playground">&#9654;</a></span></span><a class="headerlink" href="#ex-nqueens-check" title="Link to this code"></a></div>
<div class="highlight-minizinc notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">n</span><span class="p">;</span><span class="s"> </span><span class="c">% number of queens</span>
<span class="kt">set</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">ROW</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="p">;</span>
<span class="kt">set</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">COL</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="p">;</span>
<span class="kt">array</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">q</span><span class="p">;</span><span class="s"> </span><span class="c">% col of queen in each row</span>

<span class="k">test</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="kt">bool</span><span class="p">:</span><span class="s"> </span><span class="nv">b</span><span class="p">,</span><span class="kt">string</span><span class="p">:</span><span class="s"> </span><span class="nv">s</span><span class="p">)</span><span class="s"> </span><span class="o">=</span>
<span class="s">  </span><span class="k">if</span><span class="s"> </span><span class="nv">b</span><span class="s"> </span><span class="k">then</span><span class="s"> </span><span class="l">true</span><span class="s"> </span><span class="k">else</span><span class="s"> </span><span class="nf">trace_stdout</span><span class="p">(</span><span class="s">&quot;ERROR: &quot;</span><span class="o">++</span><span class="nv">s</span><span class="o">++</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="l">false</span><span class="p">)</span><span class="s"> </span><span class="k">endif</span><span class="p">;</span>

<span class="k">output</span><span class="s"> </span><span class="p">[</span>
<span class="s">  </span><span class="k">if</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="nb">index_set</span><span class="p">(</span><span class="nv">q</span><span class="p">)</span><span class="o">=</span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="p">,</span><span class="s"> &quot;ERROR: array q should have index set 1..</span><span class="p">\(</span><span class="nv">n</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="s">  </span><span class="o">/\</span><span class="s"> </span><span class="k">forall</span><span class="p">(</span><span class="nv">i</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="p">)(</span><span class="nf">check</span><span class="p">(</span><span class="nv">q</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="p">,</span><span class="s"> &quot;ERROR: q[</span><span class="p">\(</span><span class="nv">i</span><span class="p">)</span><span class="s">] should have a value in 1..</span><span class="p">\(</span><span class="nv">n</span><span class="p">)</span><span class="s">&quot;</span><span class="p">))</span>
<span class="s">  </span><span class="o">/\</span><span class="s"> </span><span class="k">forall</span><span class="p">(</span><span class="nv">r1</span><span class="p">,</span><span class="s"> </span><span class="nv">r2</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="s"> </span><span class="k">where</span><span class="s"> </span><span class="nv">r1</span><span class="s"> </span><span class="o">&lt;</span><span class="s"> </span><span class="nv">r2</span><span class="p">)</span>
<span class="s">           </span><span class="p">(</span><span class="nf">check</span><span class="p">(</span><span class="nv">q</span><span class="p">[</span><span class="nv">r1</span><span class="p">]</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">q</span><span class="p">[</span><span class="nv">r2</span><span class="p">],</span>
<span class="s">            &quot;queens in rows </span><span class="p">\(</span><span class="nv">r1</span><span class="p">)</span><span class="s"> and </span><span class="p">\(</span><span class="nv">r2</span><span class="p">)</span><span class="s"> are on same column</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="s">            </span><span class="o">/\</span>
<span class="s">            </span><span class="nf">check</span><span class="p">(</span><span class="nv">q</span><span class="p">[</span><span class="nv">r1</span><span class="p">]</span><span class="o">+</span><span class="nv">r1</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">q</span><span class="p">[</span><span class="nv">r2</span><span class="p">]</span><span class="o">+</span><span class="nv">r2</span><span class="p">,</span>
<span class="s">            &quot;queens in rows </span><span class="p">\(</span><span class="nv">r1</span><span class="p">)</span><span class="s"> and </span><span class="p">\(</span><span class="nv">r2</span><span class="p">)</span><span class="s"> are on same up diagonal</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="s">            </span><span class="o">/\</span>
<span class="s">            </span><span class="nf">check</span><span class="p">(</span><span class="nv">q</span><span class="p">[</span><span class="nv">r1</span><span class="p">]</span><span class="o">-</span><span class="nv">r1</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">q</span><span class="p">[</span><span class="nv">r2</span><span class="p">]</span><span class="o">-</span><span class="nv">r2</span><span class="p">,</span>
<span class="s">            &quot;queens in rows </span><span class="p">\(</span><span class="nv">r1</span><span class="p">)</span><span class="s"> and </span><span class="p">\(</span><span class="nv">r2</span><span class="p">)</span><span class="s"> are on same down diagonal</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="s">           </span><span class="p">)</span>
<span class="s">  </span><span class="k">then</span><span class="s"> &quot;CORRECT: All constraints hold&quot;    </span>
<span class="s">  </span><span class="k">else</span><span class="s"> &quot;INCORRECT&quot; </span><span class="k">endif</span><span class="s"> </span><span class="p">];</span>
</pre></div>
</div>
</div>
<p>The checker model first makes sure that the solution has the right dimensions (correct array index set, and each variable is assigned a value in the correct domain), and then uses standard MiniZinc constructs to check each constraint.</p>
</section>
<section id="checking-optimisation-problems">
<h3><span class="section-number">3.6.2.4. </span>Checking optimisation problems<a class="headerlink" href="#checking-optimisation-problems" title="Link to this heading"></a></h3>
<p>Optimisation problems pose a difficulty for automatic checking. When a solver claims to prove optimality, we cannot easily verify this claim without solving the problem again (using a different model that is known to be correct). At the moment, solution checking for optimisation problems is restricted to checking that the objective has been computed correctly.</p>
<p>To check that the objective value is calculated correctly, define a parameter called <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="s">_objective</span></code> of the appropriate type (<code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="kt">int</span></code> or <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="kt">float</span></code>) in the checker. The example in the next section illustrates this.</p>
</section>
<section id="hidden-variables">
<h3><span class="section-number">3.6.2.5. </span>Hidden variables<a class="headerlink" href="#hidden-variables" title="Link to this heading"></a></h3>
<p>For many models, the decision variables which describe the solution may not be the variables that are natural to describe the constraints. There may be other internal variables which are functionally defined by the decision variables, and which are likely to be used in the model for building constraints and/or are much more natural for describing the correctness of a candidate solution.</p>
<p>Consider the problem of lining up <em>n</em> people numbered from 1 to <em>n</em> for a photo
in a single line. We want to make sure that there are no more than two people of
the same gender (male, female or other) in sequence in the line. We want to
minimize the total distance between the pairs of people who are numbered
consecutively. The decisions are an array <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">pos</span></code> which for each person
gives their position in the line. A correct model for this is given in <a class="reference internal" href="#ex-photo"><span class="std std-numref">Listing 3.6.6</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="ex-photo">
<div class="code-block-caption"><span class="caption-number">Listing 3.6.6 </span><span class="caption-text">A model <a class="reference download internal" download="" href="downloads/25b91670d921c4d7db43b2b14f4cf953/photo.mzn"><tt class="xref download docutils literal">photo.mzn</tt></a> for the photo lineup problem <span class="mzn-playground-button"><a href="playground-photo.html" target="_blank" title="Open in Playground">&#9654;</a></span></span><a class="headerlink" href="#ex-photo" title="Link to this code"></a></div>
<div class="highlight-minizinc notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">n</span><span class="p">;</span><span class="s">                          </span><span class="c">% number of people</span>
<span class="kt">set</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">PERSON</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="p">;</span><span class="s">       </span><span class="c">% set of people</span>
<span class="kt">enum</span><span class="s"> </span><span class="nv">GENDER</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="p">{</span><span class="s"> </span><span class="nv">M</span><span class="p">,</span><span class="s"> </span><span class="nv">F</span><span class="p">,</span><span class="s"> </span><span class="nv">O</span><span class="s"> </span><span class="p">};</span><span class="s">       </span><span class="c">% set of genders</span>
<span class="kt">array</span><span class="p">[</span><span class="nv">PERSON</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="nv">GENDER</span><span class="p">:</span><span class="s"> </span><span class="nv">g</span><span class="p">;</span><span class="s">      </span><span class="c">% the gender of each person</span>
<span class="kt">set</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">POSN</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="p">;</span><span class="s">         </span><span class="c">% set of positions</span>

<span class="kt">array</span><span class="p">[</span><span class="nv">PERSON</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">var</span><span class="s"> </span><span class="nv">POSN</span><span class="p">:</span><span class="s"> </span><span class="nv">pos</span><span class="p">;</span><span class="s">  </span><span class="c">% decisions: a position for each person</span>

<span class="kt">array</span><span class="p">[</span><span class="nv">POSN</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">var</span><span class="s"> </span><span class="nv">PERSON</span><span class="p">:</span><span class="s"> </span><span class="nv">who</span><span class="p">;</span><span class="s">  </span><span class="c">% view: a person for each position</span>
<span class="k">include</span><span class="s"> &quot;inverse.mzn&quot;</span><span class="p">;</span>
<span class="k">constraint</span><span class="s"> </span><span class="bp">inverse</span><span class="p">(</span><span class="nv">pos</span><span class="p">,</span><span class="nv">who</span><span class="p">);</span><span class="s">     </span><span class="c">% channel from decisions to view</span>
<span class="k">constraint</span><span class="s"> </span><span class="k">forall</span><span class="p">(</span><span class="nv">i</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="o">-</span><span class="m">2</span><span class="p">)</span>
<span class="s">                 </span><span class="p">(</span><span class="nv">g</span><span class="p">[</span><span class="nv">who</span><span class="p">[</span><span class="nv">i</span><span class="p">]]</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">g</span><span class="p">[</span><span class="nv">who</span><span class="p">[</span><span class="nv">i</span><span class="o">+</span><span class="m">1</span><span class="p">]]</span><span class="s"> </span><span class="o">\/</span><span class="s"> </span><span class="nv">g</span><span class="p">[</span><span class="nv">who</span><span class="p">[</span><span class="nv">i</span><span class="o">+</span><span class="m">1</span><span class="p">]]</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">g</span><span class="p">[</span><span class="nv">who</span><span class="p">[</span><span class="nv">i</span><span class="o">+</span><span class="m">2</span><span class="p">]]);</span>

<span class="k">solve</span><span class="s"> </span><span class="k">minimize</span><span class="s"> </span><span class="nb">sum</span><span class="p">(</span><span class="nv">i</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="o">-</span><span class="m">1</span><span class="p">)(</span><span class="nb">abs</span><span class="p">(</span><span class="nv">pos</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span><span class="s"> </span><span class="o">-</span><span class="s"> </span><span class="nv">pos</span><span class="p">[</span><span class="nv">i</span><span class="o">+</span><span class="m">1</span><span class="p">]));</span>
</pre></div>
</div>
</div>
<p>A critical part of learning how to model this problem is to realise
that it is worth introducing the inverse of the <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">pos</span></code> variables, called <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">who</span></code> in this model. The <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">who</span></code> array makes it much easier to specify that no more than two people of the same gender can be
adjacent. The checker model <strong>should not</strong> include the <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">who</span></code> variables, because that would effectively give away the key to the solution.</p>
<p>The use of hidden variables (such as <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">who</span></code>) makes checking harder in two
ways. First, we may need to define these in the checker model as decision variables (rather than parameters), and MiniZinc will then need to invoke a solver to generate the values of these variables in order to check a given solution. Second, given an incorrect candidate solution, there may be
no possible value for these hidden variables, hence we have to guard the
checking to ensure we do not assume that there is some value for the hidden
variables.</p>
<p>Consider this data file for the photo problem:</p>
<div class="literal-block-wrapper docutils container" id="ex-photo-data">
<div class="code-block-caption"><span class="caption-number">Listing 3.6.7 </span><span class="caption-text">Example data for the <a class="reference download internal" download="" href="downloads/25b91670d921c4d7db43b2b14f4cf953/photo.mzn"><tt class="xref download docutils literal">photo.mzn</tt></a> photo lineup problem (<a class="reference download internal" download="" href="downloads/7b25fc0e5fba4c35afba5ba90aa12c7a/photo.dzn"><tt class="xref download docutils literal">photo.dzn</tt></a>)  <span class="mzn-playground-button"><a href="playground-photo.html" target="_blank" title="Open in Playground">&#9654;</a></span></span><a class="headerlink" href="#ex-photo-data" title="Link to this code"></a></div>
<div class="highlight-minizinc notranslate"><div class="highlight"><pre><span></span><span class="nv">n</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">9</span><span class="p">;</span>
<span class="nv">g</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="p">[</span><span class="nv">M</span><span class="p">,</span><span class="nv">M</span><span class="p">,</span><span class="nv">M</span><span class="p">,</span><span class="nv">M</span><span class="p">,</span><span class="nv">F</span><span class="p">,</span><span class="nv">F</span><span class="p">,</span><span class="nv">F</span><span class="p">,</span><span class="nv">M</span><span class="p">,</span><span class="nv">M</span><span class="p">];</span>
</pre></div>
</div>
</div>
<div class="highlight-minizinc notranslate"><div class="highlight"><pre><span></span><span class="nv">n</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">9</span><span class="p">;</span>
<span class="nv">g</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="p">[</span><span class="nv">M</span><span class="p">,</span><span class="nv">M</span><span class="p">,</span><span class="nv">M</span><span class="p">,</span><span class="nv">M</span><span class="p">,</span><span class="nv">F</span><span class="p">,</span><span class="nv">F</span><span class="p">,</span><span class="nv">F</span><span class="p">,</span><span class="nv">M</span><span class="p">,</span><span class="nv">M</span><span class="p">];</span>
</pre></div>
</div>
<p>and assume that an incorrect model returns the erroneous candidate solution
<code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">pos</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="p">[</span><span class="m">1,2</span><span class="p">,</span><span class="m">3,4</span><span class="p">,</span><span class="m">5,6</span><span class="p">,</span><span class="m">7,2</span><span class="p">,</span><span class="m">9</span><span class="p">];</span><span class="s"> _objective</span><span class="o">=</span><span class="m">25</span><span class="p">;</span></code>. If we simply assert <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="bp">inverse</span><span class="p">(</span><span class="nv">pos</span><span class="p">,</span><span class="nv">who</span><span class="p">)</span></code> in the checker model, then this constraint will
fail since there is no inverse of this position array, because persons 2 and
8 are both at position 2.  Hence the checker must guard the inverse
constraint, and only when that succeeds use  the computed values of the
<code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">who</span></code> variables for checking the solution. A checking model for the photo problem might look like this:</p>
<div class="literal-block-wrapper docutils container" id="ex-photo-checker">
<div class="code-block-caption"><span class="caption-number">Listing 3.6.8 </span><span class="caption-text">A checker model <a class="reference download internal" download="" href="downloads/82f9f0c4cef1430e097b84caf6202985/photo.mzc.mzn"><tt class="xref download docutils literal">photo.mzc.mzn</tt></a> for the photo lineup problem <span class="mzn-playground-button"><a href="playground-photo.html" target="_blank" title="Open in Playground">&#9654;</a></span></span><a class="headerlink" href="#ex-photo-checker" title="Link to this code"></a></div>
<div class="highlight-minizinc notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">n</span><span class="p">;</span>
<span class="kt">set</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">PERSON</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="p">;</span>
<span class="kt">enum</span><span class="s"> </span><span class="nv">GENDER</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="p">{</span><span class="s"> </span><span class="nv">M</span><span class="p">,</span><span class="s"> </span><span class="nv">F</span><span class="p">,</span><span class="s"> </span><span class="nv">O</span><span class="s"> </span><span class="p">};</span>
<span class="kt">array</span><span class="p">[</span><span class="nv">PERSON</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="nv">GENDER</span><span class="p">:</span><span class="s"> </span><span class="nv">g</span><span class="p">;</span>
<span class="kt">set</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">POSN</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="p">;</span>
<span class="kt">array</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">pos</span><span class="p">;</span>

<span class="kt">array</span><span class="p">[</span><span class="nv">POSN</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">var</span><span class="s"> </span><span class="nv">PERSON</span><span class="p">:</span><span class="s"> </span><span class="nv">who</span><span class="p">;</span>
<span class="kt">int</span><span class="p">:</span><span class="s"> _objective</span><span class="p">;</span>

<span class="k">test</span><span class="s"> </span><span class="nf">alldifferent</span><span class="p">(</span><span class="kt">array</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">x</span><span class="p">)</span><span class="s"> </span><span class="o">=</span>
<span class="s">                 </span><span class="k">forall</span><span class="p">(</span><span class="nv">i</span><span class="p">,</span><span class="nv">j</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="nb">index_set</span><span class="p">(</span><span class="nv">x</span><span class="p">)</span><span class="s"> </span><span class="k">where</span><span class="s"> </span><span class="nv">i</span><span class="s"> </span><span class="o">&lt;</span><span class="s"> </span><span class="nv">j</span><span class="p">)(</span><span class="nv">x</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">x</span><span class="p">[</span><span class="nv">j</span><span class="p">]);</span>

<span class="k">include</span><span class="s"> &quot;inverse.mzn&quot;</span><span class="p">;</span>
<span class="k">constraint</span><span class="s"> </span><span class="k">if</span><span class="s"> </span><span class="nf">alldifferent</span><span class="p">(</span><span class="nv">pos</span><span class="p">)</span><span class="s"> </span><span class="k">then</span><span class="s"> </span><span class="bp">inverse</span><span class="p">(</span><span class="nv">pos</span><span class="p">,</span><span class="nv">who</span><span class="p">)</span><span class="s"> </span>
<span class="s">           </span><span class="k">else</span><span class="s"> </span><span class="k">forall</span><span class="p">(</span><span class="nv">i</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="p">)(</span><span class="nv">who</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">1</span><span class="p">)</span><span class="s"> </span><span class="k">endif</span><span class="p">;</span>

<span class="k">output</span><span class="s"> </span><span class="p">[</span><span class="k">if</span><span class="s"> </span>
<span class="s">  </span><span class="nf">check_array</span><span class="p">(</span><span class="nv">pos</span><span class="p">,</span><span class="s"> </span><span class="nv">n</span><span class="p">,</span><span class="s"> </span><span class="nv">POSN</span><span class="p">,</span><span class="s"> &quot;pos&quot;</span><span class="p">)</span><span class="s"> </span><span class="o">/\</span>
<span class="s">  </span><span class="nf">check_alldifferent</span><span class="p">(</span><span class="nv">pos</span><span class="p">,</span><span class="s">&quot;pos&quot;</span><span class="p">)</span><span class="s"> </span><span class="o">/\</span>
<span class="s">  </span><span class="nf">check_array</span><span class="p">(</span><span class="nb">fix</span><span class="p">(</span><span class="nv">pos</span><span class="p">),</span><span class="s"> </span><span class="nv">n</span><span class="p">,</span><span class="s"> </span><span class="nv">PERSON</span><span class="p">,</span><span class="s"> &quot;who&quot;</span><span class="p">)</span><span class="s"> </span><span class="o">/\</span>
<span class="s">  </span><span class="k">forall</span><span class="p">(</span><span class="nv">i</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="o">-</span><span class="m">2</span><span class="p">)</span>
<span class="s">        </span><span class="p">(</span><span class="nf">check</span><span class="p">(</span><span class="nv">g</span><span class="p">[</span><span class="nb">fix</span><span class="p">(</span><span class="nv">who</span><span class="p">[</span><span class="nv">i</span><span class="p">])]</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">g</span><span class="p">[</span><span class="nb">fix</span><span class="p">(</span><span class="nv">who</span><span class="p">[</span><span class="nv">i</span><span class="o">+</span><span class="m">1</span><span class="p">])]</span><span class="s"> </span><span class="o">\/</span>
<span class="s">               </span><span class="nv">g</span><span class="p">[</span><span class="nb">fix</span><span class="p">(</span><span class="nv">who</span><span class="p">[</span><span class="nv">i</span><span class="o">+</span><span class="m">1</span><span class="p">])]</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">g</span><span class="p">[</span><span class="nb">fix</span><span class="p">(</span><span class="nv">who</span><span class="p">[</span><span class="nv">i</span><span class="o">+</span><span class="m">2</span><span class="p">])],</span>
<span class="s">               &quot;three people of the same gender </span><span class="p">\(</span><span class="nv">g</span><span class="p">[</span><span class="nb">fix</span><span class="p">(</span><span class="nv">who</span><span class="p">[</span><span class="nv">i</span><span class="p">])])</span><span class="s"> in positions </span><span class="p">\(</span><span class="nv">i</span><span class="p">)</span><span class="s">..</span><span class="p">\(</span><span class="nv">i</span><span class="o">+</span><span class="m">2</span><span class="p">)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">))</span><span class="s"> </span><span class="o">/\</span>
<span class="s">  </span><span class="k">let</span><span class="s"> </span><span class="p">{</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">obj</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="nb">sum</span><span class="p">(</span><span class="nv">i</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="o">-</span><span class="m">1</span><span class="p">)(</span><span class="nb">abs</span><span class="p">(</span><span class="nv">pos</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span><span class="s"> </span><span class="o">-</span><span class="s"> </span><span class="nv">pos</span><span class="p">[</span><span class="nv">i</span><span class="o">+</span><span class="m">1</span><span class="p">]));</span><span class="s"> </span><span class="p">}</span><span class="s"> </span><span class="k">in</span>
<span class="s">    </span><span class="nf">check</span><span class="p">(</span><span class="nv">obj</span><span class="s"> </span><span class="o">=</span><span class="s"> _objective</span><span class="p">,</span><span class="s"> &quot;calculated objective </span><span class="p">\(</span><span class="nv">obj</span><span class="p">)</span><span class="s"> does not agree with objective from the model (</span><span class="p">\(</span><span class="s">_objective</span><span class="p">)</span><span class="s">)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="s">  </span><span class="k">then</span>
<span class="s">    &quot;CORRECT: All constraints hold&quot;</span>
<span class="s">  </span><span class="k">else</span><span class="s">       </span>
<span class="s">    &quot;INCORRECT&quot;</span>
<span class="s">  </span><span class="k">endif</span><span class="p">];</span>
<span class="s">              </span>
<span class="k">test</span><span class="s"> </span><span class="nf">check</span><span class="p">(</span><span class="kt">bool</span><span class="p">:</span><span class="s"> </span><span class="nv">b</span><span class="p">,</span><span class="kt">string</span><span class="p">:</span><span class="s"> </span><span class="nv">s</span><span class="p">)</span><span class="s"> </span><span class="o">=</span>
<span class="s">  </span><span class="k">if</span><span class="s"> </span><span class="nv">b</span><span class="s"> </span><span class="k">then</span><span class="s"> </span><span class="l">true</span><span class="s"> </span><span class="k">else</span><span class="s"> </span><span class="nf">trace_stdout</span><span class="p">(</span><span class="s">&quot;ERROR: &quot;</span><span class="o">++</span><span class="nv">s</span><span class="o">++</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="l">false</span><span class="p">)</span><span class="s"> </span><span class="k">endif</span><span class="p">;</span>

<span class="k">test</span><span class="s"> </span><span class="nf">check_alldifferent</span><span class="p">(</span><span class="kt">array</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">x</span><span class="p">,</span><span class="s"> </span><span class="kt">string</span><span class="p">:</span><span class="s"> </span><span class="nv">name</span><span class="p">)</span><span class="s"> </span><span class="o">=</span>
<span class="s">  </span><span class="k">forall</span><span class="p">(</span><span class="nv">i</span><span class="p">,</span><span class="s"> </span><span class="nv">j</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="nb">index_set</span><span class="p">(</span><span class="nv">x</span><span class="p">)</span><span class="s"> </span><span class="k">where</span><span class="s"> </span><span class="nv">i</span><span class="s"> </span><span class="o">&lt;</span><span class="s"> </span><span class="nv">j</span><span class="p">)</span>
<span class="s">        </span><span class="p">(</span><span class="nf">check</span><span class="p">(</span><span class="nv">x</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span><span class="s"> </span><span class="o">!=</span><span class="s"> </span><span class="nv">x</span><span class="p">[</span><span class="nv">j</span><span class="p">],</span><span class="s"> </span><span class="nv">name</span><span class="s"> </span><span class="o">++</span><span class="s"> &quot;[</span><span class="p">\(</span><span class="nv">i</span><span class="p">)</span><span class="s">] = </span><span class="p">\(</span><span class="nv">x</span><span class="p">[</span><span class="nv">i</span><span class="p">])</span><span class="s"> = &quot; </span><span class="o">++</span><span class="s"> </span>
<span class="s">         </span><span class="nv">name</span><span class="s"> </span><span class="o">++</span><span class="s"> &quot;[</span><span class="p">\(</span><span class="nv">j</span><span class="p">)</span><span class="s">] &quot; </span><span class="o">++</span>
<span class="s">         &quot;when they should be different</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">));</span><span class="s">              </span>
<span class="s"> </span>
<span class="k">test</span><span class="s"> </span><span class="nf">check_int</span><span class="p">(</span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">x</span><span class="p">,</span><span class="s"> </span><span class="kt">set</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">vals</span><span class="p">,</span><span class="s"> </span><span class="kt">string</span><span class="p">:</span><span class="s"> </span><span class="nv">name</span><span class="p">)</span><span class="s"> </span><span class="o">=</span>
<span class="s">  </span><span class="nf">check</span><span class="p">(</span><span class="nv">x</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="nv">vals</span><span class="p">,</span><span class="s"> &quot;integer </span><span class="p">\(</span><span class="nv">name</span><span class="p">)</span><span class="s"> is not in values </span><span class="p">\(</span><span class="nv">vals</span><span class="p">)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="k">function</span><span class="s"> </span><span class="kt">bool</span><span class="p">:</span><span class="s"> </span><span class="nf">check_array</span><span class="p">(</span><span class="kt">array</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">x</span><span class="p">,</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nb">length</span><span class="p">,</span><span class="s"> </span><span class="kt">set</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">vals</span><span class="p">,</span><span class="s"> </span><span class="kt">string</span><span class="p">:</span><span class="s"> </span><span class="nv">name</span><span class="p">)</span><span class="s"> </span><span class="o">=</span>
<span class="s">  </span><span class="nf">check</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="nv">x</span><span class="p">)</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="nb">length</span><span class="p">,</span><span class="s"> &quot;array </span><span class="p">\(</span><span class="nv">name</span><span class="p">)</span><span class="s"> is not of length </span><span class="p">\(</span><span class="nb">length</span><span class="p">)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span><span class="s"> </span><span class="o">/\</span>
<span class="s">  </span><span class="k">forall</span><span class="p">(</span><span class="nv">i</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="nb">index_set</span><span class="p">(</span><span class="nv">x</span><span class="p">))</span><span class="s"> </span>
<span class="s">        </span><span class="p">(</span><span class="nf">check</span><span class="p">(</span><span class="nv">x</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="nv">vals</span><span class="p">,</span><span class="s"> &quot;element </span><span class="p">\(</span><span class="nv">i</span><span class="p">)</span><span class="s"> of array </span><span class="p">\(</span><span class="nv">name</span><span class="p">)</span><span class="s">, </span><span class="p">\(</span><span class="nv">x</span><span class="p">[</span><span class="nv">i</span><span class="p">])</span><span class="s"> is not in values </span><span class="p">\(</span><span class="nv">vals</span><span class="p">)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">));</span><span class="s">  </span>
</pre></div>
</div>
</div>
<p>The checker model first tests whether the given <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">pos</span></code> array satisfies the <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">alldifferent</span></code> property (using a custom <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="k">test</span></code> for <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">alldifferent</span></code> on a par array). If it passes the test, the <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="bp">inverse</span></code> constraint is applied. Otherwise, the <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">who</span></code> array is simply fixed to a list of ones.</p>
<p>The check for the <code class="code mzn minizinc docutils literal highlight highlight-minizinc"><span></span><span class="nv">alldifferent</span></code> constraint is a good example for a checker that tries to give a detailed description of the error.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="solvers.html" class="btn btn-neutral float-left" title="3.5. Solving Technologies and Solver Backends" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="globalizer.html" class="btn btn-neutral float-right" title="3.7. Globalizer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016, 2017, 2018, 2019, 2020 Peter J. Stuckey, Kim Marriott, Guido Tack.</p>
  </div>

  
<a rel="license" href="http://creativecommons.org/licenses/by-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nd/4.0/80x15.png" /></a>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-63390311-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-63390311-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>
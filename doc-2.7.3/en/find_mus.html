

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.8. FindMUS &mdash; The MiniZinc Handbook 2.7.3</title>
  

  
  
  
  
    <link rel="canonical" href="http://www.minizinc.org/doc-latest/en/find_mus.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="static/style.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3.9. Using MiniZinc in Jupyter Notebooks" href="jupyter.html" />
    <link rel="prev" title="3.7. Globalizer" href="globalizer.html" />
    <link rel="apple-touch-icon" sizes="57x57" href="static/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="static/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="static/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="static/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="static/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="static/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="static/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="static/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="static/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="static/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="static/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="static/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="static/favicon/favicon-16x16.png">
    <link rel="manifest" href="static/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="static/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">


  
  <script src="static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          
            <a href="http://www.minizinc.org">
          
            
            <img src="static/MiniZn_logo_2.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
              <div class="version">
                2.7.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            <a href="index.html" class="reference internal icon icon-home"> The MiniZinc Handbook </a>
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="part_1_overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="part_2_tutorial.html">2. A MiniZinc Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="part_3_user_manual.html">3. User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="command_line.html">3.1. The MiniZinc Command Line Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="minizinc_ide.html">3.2. The MiniZinc IDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualisation.html">3.3. Visualising solutions in the MiniZinc IDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpprofiler.html">3.4. CP-Profiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="solvers.html">3.5. Solving Technologies and Solver Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="checkers.html">3.6. Automatic Solution Checking, Model Validation, and Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="globalizer.html">3.7. Globalizer</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.8. FindMUS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-usage">3.8.1. Basic Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#commandline-arguments">3.8.1.1. Commandline arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example">3.8.1.2. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-findmus-in-the-minizinc-ide">3.8.2. Using FindMUS in the MiniZinc IDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-it-works">3.8.3. How it works</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performance-tips">3.8.4. Performance tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limitations-future-work">3.8.5. Limitations / Future work</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="jupyter.html">3.9. Using MiniZinc in Jupyter Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html">3.10. Python Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="javascript.html">3.11. JavaScript Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation_detailed.html">3.12. Installation from Source Code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="part_4_reference.html">4. Reference Manual</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">The MiniZinc Handbook</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="part_3_user_manual.html">3. User Manual</a> &raquo;</li>
        
      <li>3.8. FindMUS</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="findmus">
<h1>3.8. FindMUS<a class="headerlink" href="#findmus" title="Permalink to this headline">¶</a></h1>
<p>Version: 0.6.0</p>
<p>FindMUS <a class="footnote-reference" href="#id6" id="id1">[1]</a> lists unsatisfiable subsets of constraints in your MiniZinc
model.  These subsets, called Minimal Unsatisfiable Subsets can help
you to find faults in your unsatisfiable constraint model.  FindMUS uses
the hierarchical structure provided by the model to guide its search.</p>
<div class="section" id="basic-usage">
<h2>3.8.1. Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<p>To use FindMUS on the command line simply execute it on a model and set
of data files by typing:</p>
<p><tt class="docutils literal">findMUS model.mzn data-1.dzn</tt></p>
<p>This will perform a search for a single instance level MUS.
To acquire a low level MUS the <tt class="docutils literal">--paramset fzn</tt> argument can be used.
To search for more than one MUS use the <tt class="docutils literal">-a</tt> or <tt class="docutils literal">-n <count></tt> arguments.
By default FindMUS will use <tt class="docutils literal">gecode_presolver</tt> for checking the
satisfiability of a subset of constraints. This can be changed using the
<tt class="docutils literal">--subsolver</tt> argument.  For example, given a model that is better
suited to a Mixed Integer Programming solver, the argument
<tt class="docutils literal">--solver cbc</tt> could be used to instruct FindMUS to flatten the model
with the linear library and use the CBC solver for satisfiability checking.</p>
<p>Note: FindMUS requires a fully instantiated constraint model.</p>
<div class="section" id="commandline-arguments">
<h3>3.8.1.1. Commandline arguments<a class="headerlink" href="#commandline-arguments" title="Permalink to this headline">¶</a></h3>
<p>The FindMUS tool supports the following arguments:</p>
<p><strong>Driver options</strong></p>
<p>The driver creates the map solver and sub-solver and requests MUSes from
FindMUS’s enumeration algorithm HierMUS.</p>
<p><tt class="docutils literal">-n &lt;count&gt;</tt>   Stop after the <em>n</em> th MUS is found (Default: 1)</p>
<p><tt class="docutils literal">-a</tt>   Find all MUSes (equivalent to <tt class="docutils literal">-n 0</tt>)</p>
<p><tt class="docutils literal">-t</tt> or <tt class="docutils literal">--timeout &lt;s&gt</tt>   Stop search after <em>s</em> seconds (Default: 1800)</p>
<dl class="docutils">
<dt><tt class="docutils literal">--paramset hint,mzn,fzn</tt></dt>
<dd><p class="first">Use a preset collection of parameters. (Default: mzn)
The <tt class="docutils literal">mzn</tt> and <tt class="docutils literal">fzn</tt> options can acquire MUSes in more detail.</p>
<p><tt class="docutils literal">hint</tt> –structure gen –depth mzn –shrink-alg map_lin</p>
<p><tt class="docutils literal">mzn</tt> –structure normal –depth mzn –shrink-alg map_qx</p>
<p class="last"><tt class="docutils literal">fzn</tt> –structure normal –depth fzn –shrink-alg map_qx</p>
</dd>
<dt><tt class="docutils literal">--no-leftover</tt></dt>
<dd>Do not print leftover candidate on timeout
If FindMUS is exploring an unsatisfiable subset when it runs out of time,
it behaves as if the set could not be reduced to a smaller set and prints
it as an MUS. The <tt class="docutils literal">--no-leftover</tt> setting disables this behaviour as
these sets can sometimes be quite large.</dd>
</dl>
<p><tt class="docutils literal">--frequent-stats</tt> Print statistics after every MUS discovered.</p>
<p><tt class="docutils literal">--no-progress</tt> Disable <tt class="docutils literal">%%%mzn-progress</tt> output</p>
<p><tt class="docutils literal">--no-stats</tt> Disable output of initial parsing stats and summary stats</p>
<p><tt class="docutils literal">--output-{html, json, brief, human}</tt> Changes output mode</p>
<blockquote>
<div><p><tt class="docutils literal">html</tt> HTML output mode for use with the MiniZinc IDE</p>
<p><tt class="docutils literal">json</tt> Simple json output (each MUS should be parsed separately)</p>
<p><tt class="docutils literal">brief</tt> Same as the default output mode but without outputting the traces (paths)</p>
<p><tt class="docutils literal">human</tt>
Tries to format the MUS in a more readable form grouping constraints by their constraint names</p>
</div></blockquote>
<p><strong>Compiler Options</strong></p>
<p><tt class="docutils literal">-g</tt> or <tt class="docutils literal">--domains</tt> Record domain changes during compilation (same as <tt class="docutils literal">minizinc -c -g</tt>)</p>
<p><tt class="docutils literal">--verbose-compile</tt> Pass <tt class="docutils literal">--verbose</tt> to MiniZinc compiler</p>
<p><strong>Enumeration options</strong></p>
<p>The enumeration algorithm (HierMUS) explores the constraint hierarchy
provided in the user’s model and proposes potential MUSes to the
sub-solver.  A <tt class="docutils literal">shrink</tt> algorithm is used to reduce found UNSAT subsets
to MUSes. There are currently four available shrink algorithms available
with FindMUS.</p>
<dl class="docutils">
<dt><tt class="docutils literal">--shrink-alg lin,map_lin,qx,map_qx,qx2</tt></dt>
<dd><p class="first">Select shrink algorithm (Default: map_lin)</p>
<blockquote class="last">
<div><p><tt class="docutils literal">lin</tt> simple linear shrink algorithm.</p>
<p><tt class="docutils literal">map_lin</tt> alternative implementation of the linear algorithm that
updates a global map of explored subsets while shrinking the subset.</p>
<p><tt class="docutils literal">qx</tt> uses the <tt class="docutils literal">QuickXplain</tt> <a class="footnote-reference" href="#id9" id="id2">[4]</a> algorithm to shrink the subset
to a MUS.</p>
<p><tt class="docutils literal">map_qx</tt> is an alternative implementation of <tt class="docutils literal">QuickXplain</tt> that
uses the global map to split subsets, and to avoid repeating any SAT
checks while shrinking</p>
<p><tt class="docutils literal">qx2</tt> a lightweight alternative to <tt class="docutils literal">map_qx</tt> that only uses the
map to avoid repeating SAT checks.</p>
</div></blockquote>
</dd>
<dt><tt class="docutils literal">--depth mzn,fzn,&lt;n&gt</tt></dt>
<dd><p class="first">How deep in the tree should search explore. (Default: mzn)</p>
<blockquote class="last">
<div><p><tt class="docutils literal">mzn</tt> expands the search as far as the point when the compiler
leaves the MiniZinc model.</p>
<p><tt class="docutils literal">fzn</tt> expands search as far as the FlatZinc constraints.</p>
<p><tt class="docutils literal">&lt;n&gt</tt> expand search to the <em>n</em> level of the hierarchy.</p>
</div></blockquote>
</dd>
</dl>
<p><tt class="docutils literal">--restarts</tt> Enable restart to flat mode (plain Marco) if large run of SAT sets encountered</p>
<p><tt class="docutils literal">--seed <n></tt> Set the random seed used for splitting with <tt class="docutils literal">map_qx</tt></p>
<p><strong>Subsolver options</strong></p>
<p>FindMUS can be used in conjunction with any FlatZinc solver. These
options mimic the <tt class="docutils literal">minizinc</tt> arguments <tt class="docutils literal">--solver</tt> and
<tt class="docutils literal">--fzn-flags</tt>. The behavior of these arguments is likely to change
in later versions of the tool.</p>
<dl class="docutils">
<dt><tt class="docutils literal">--subsolver &lt;s&gt</tt></dt>
<dd>Use solver <em>s</em> for SAT checking. (Default: “gecode”)</dd>
<dt><tt class="docutils literal">--solver-flags &lt;f&gt</tt></dt>
<dd>Pass flags <em>f</em> to sub-solver. (Default: empty)</dd>
<dt><tt class="docutils literal">--solver-timelimit &lt;ms&gt</tt></dt>
<dd>Set hard time limit for solver in milliseconds. (Default: 1100)</dd>
<dt><tt class="docutils literal">--adapt-timelimit</tt></dt>
<dd>Automatically tighten solver timelimit based on
performance during initial sanity check (prove background is SAT,
background + entire foreground is UNSAT)</dd>
</dl>
<p><strong>Filtering options</strong></p>
<p>FindMUS can include or exclude constraints from its search based on the
expression and constraint name annotations as well as properties of their
paths (for example, line numbers). These filters are currently based on
substrings but in future may support text spans and regular expressions.</p>
<dl class="docutils">
<dt><tt class="docutils literal">--soft-defines</tt></dt>
<dd>Consider functional constraints as part of MUSes</dd>
<dt><tt class="docutils literal">--hard-domains</tt></dt>
<dd>Consider domain constraints (added by <tt class="docutils literal">-g</tt> option) as background</dd>
<dt><tt class="docutils literal">--named-only</tt></dt>
<dd>Only consider constraints annotated with string annotations</dd>
</dl>
<p><tt class="docutils literal">--filter-mode fg,ex</tt> Filtering mode</p>
<blockquote>
<div><p><tt class="docutils literal">fg</tt> Foreground: Excluded items go to the background</p>
<p><tt class="docutils literal">ex</tt> Exclusive: Excluded items are omitted entirely (Useful if they are
part of MUSes you are not interested in)</p>
</div></blockquote>
<p><tt class="docutils literal">--filter-named &lt;names&gt;</tt> <tt class="docutils literal">--filter-named-exclude &lt;names&gt;</tt>
Include/exclude constraints with names that match <em>sep</em> separated <em>names</em></p>
<p><tt class="docutils literal">--filter-path &lt;paths&gt;</tt> <tt class="docutils literal">--filter-path-exclude &lt;paths&gt;</tt>
Include/exclude based on <em>paths</em></p>
<p><tt class="docutils literal">--filter-sep &lt;sep&gt;</tt> Separator used for named and path filters</p>
<p><strong>Structure options</strong></p>
<p>The structure coming from a user’s model can significantly impact the
performance of a MUS enumeration algorithm. The hierarchy is constructed
in two steps. The first takes the existing model structure and can modify
it in several ways. The second step adds extra binary structure.</p>
<p><tt class="docutils literal">--structure flat,gen,normal,mix</tt></p>
<blockquote>
<div><p>Alters initial structure: (Default: <tt class="docutils literal">gen</tt>)</p>
<p><tt class="docutils literal">flat</tt>   Remove all structure</p>
<p><tt class="docutils literal">gen</tt>    Remove instance specific structure (merges constraints)</p>
<p><tt class="docutils literal">normal</tt> No change</p>
<p><tt class="docutils literal">mix</tt>    Apply <tt class="docutils literal">gen</tt> before <tt class="docutils literal">normal</tt></p>
<p><tt class="docutils literal">idx</tt>    Remove all location information</p>
<p><tt class="docutils literal">idxmix</tt> Apply <tt class="docutils literal">idx</tt> before <tt class="docutils literal">normal</tt></p>
</div></blockquote>
<p><tt class="docutils literal">--no-binarize</tt></p>
<blockquote>
<div>By default FindMUS  will introduce extra binary structure to the
hierarchy. This option disables this behaviour (This is likely to be
the default in future since QX performs a type of binarization).</div></blockquote>
<p><strong>Verbosity options</strong></p>
<p><tt class="docutils literal">--verbose-{map,enum,subsolve} &lt;n&gt</tt> Set verbosity level for
different components. Currently <tt class="docutils literal">n</tt> can only take values 0, 1, and 2;</p>
<p><tt class="docutils literal">--verbose</tt> Set verbosity level of all components to 1</p>
<p><strong>Misc options</strong></p>
<p><tt class="docutils literal">--dump-dot &lt;dot&gt</tt> Write tree in GraphViz format to file &lt;dot&gt;</p>
</div>
<div class="section" id="example">
<h3>3.8.1.2. Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>The following demonstrates the basic usage of FindMUS on a simple example.
Below, we see a model for the latin squares puzzle <a class="footnote-reference" href="#id7" id="id3">[2]</a> with some
incompatible symmetry breaking constraints added.</p>
<div class="literal-block-wrapper docutils container" id="ex-mus-latin">
<div class="code-block-caption"><span class="caption-number">Listing 3.8.1 </span><span class="caption-text">Faulty model for Latin Squares (<a class="reference download internal" href="downloads/latin_squares.mzn" download=""><tt class="xref download docutils literal">latin_squares.mzn</tt></a>).</span><a class="headerlink" href="#ex-mus-latin" title="Permalink to this code">¶</a></div>
<div class="highlight-minizinc notranslate"><div class="highlight"><pre><span></span><span class="c">% latin_squares.mzn</span><span class="s"></span>
<span class="k">include</span><span class="s"> &quot;globals.mzn&quot;</span><span class="p">;</span><span class="s"></span>

<span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">n</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">3</span><span class="p">;</span><span class="s"></span>
<span class="kt">set</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">int</span><span class="p">:</span><span class="s"> </span><span class="nv">N</span><span class="s"> </span><span class="o">=</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="p">;</span><span class="s"></span>
<span class="kt">array</span><span class="p">[</span><span class="nv">N</span><span class="p">,</span><span class="s"> </span><span class="nv">N</span><span class="p">]</span><span class="s"> </span><span class="kt">of</span><span class="s"> </span><span class="kt">var</span><span class="s"> </span><span class="nv">N</span><span class="p">:</span><span class="s"> </span><span class="nv">X</span><span class="p">;</span><span class="s"></span>

<span class="k">constraint</span><span class="s"> </span><span class="p">::</span><span class="s"> &quot;ADRows&quot;</span>
<span class="s">    </span><span class="k">forall</span><span class="s"> </span><span class="p">(</span><span class="nv">i</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="nv">N</span><span class="p">)</span><span class="s"></span>
<span class="s">        </span><span class="p">(</span><span class="nf">alldifferent</span><span class="p">(</span><span class="nv">X</span><span class="p">[</span><span class="nv">i</span><span class="p">,</span><span class="s">..</span><span class="p">])</span><span class="s">           </span><span class="p">::</span><span class="s"> &quot;AD(row </span><span class="p">\(</span><span class="nv">i</span><span class="p">)</span><span class="s">)&quot;</span>
<span class="s">        </span><span class="p">);</span><span class="s"></span>
<span class="k">constraint</span><span class="s"> </span><span class="p">::</span><span class="s"> &quot;ADCols&quot;</span>
<span class="s">    </span><span class="k">forall</span><span class="s"> </span><span class="p">(</span><span class="nv">j</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="nv">N</span><span class="p">)</span><span class="s"></span>
<span class="s">        </span><span class="p">(</span><span class="nf">alldifferent</span><span class="p">(</span><span class="nv">X</span><span class="p">[</span><span class="s">..</span><span class="p">,</span><span class="nv">j</span><span class="p">])</span><span class="s">           </span><span class="p">::</span><span class="s"> &quot;AD(col </span><span class="p">\(</span><span class="nv">j</span><span class="p">)</span><span class="s">)&quot;</span>
<span class="s">        </span><span class="p">);</span><span class="s"></span>

<span class="k">constraint</span><span class="s"> </span><span class="p">::</span><span class="s"> &quot;LLRows&quot;</span>
<span class="s">    </span><span class="k">forall</span><span class="s"> </span><span class="p">(</span><span class="nv">i</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="o">-</span><span class="m">1</span><span class="p">)</span><span class="s"></span>
<span class="s">        </span><span class="p">(</span><span class="bp">lex_less</span><span class="p">(</span><span class="nv">X</span><span class="p">[</span><span class="nv">i</span><span class="p">,</span><span class="s">..</span><span class="p">],</span><span class="s"> </span><span class="nv">X</span><span class="p">[</span><span class="nv">i</span><span class="o">+</span><span class="m">1</span><span class="p">,</span><span class="s">..</span><span class="p">])</span><span class="s">    </span><span class="p">::</span><span class="s"> &quot;LL(rows </span><span class="p">\(</span><span class="nv">i</span><span class="p">)</span><span class="s"> </span><span class="p">\(</span><span class="nv">i</span><span class="o">+</span><span class="m">1</span><span class="p">)</span><span class="s">)&quot;</span>
<span class="s">        </span><span class="p">);</span><span class="s"></span>
<span class="k">constraint</span><span class="s"> </span><span class="p">::</span><span class="s"> &quot;LGCols&quot;</span>
<span class="s">    </span><span class="k">forall</span><span class="s"> </span><span class="p">(</span><span class="nv">j</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="m">1</span><span class="o">..</span><span class="nv">n</span><span class="o">-</span><span class="m">1</span><span class="p">)</span><span class="s"></span>
<span class="s">        </span><span class="p">(</span><span class="bp">lex_greater</span><span class="p">(</span><span class="nv">X</span><span class="p">[</span><span class="s">..</span><span class="p">,</span><span class="nv">j</span><span class="p">],</span><span class="s"> </span><span class="nv">X</span><span class="p">[</span><span class="s">..</span><span class="p">,</span><span class="nv">j</span><span class="o">+</span><span class="m">1</span><span class="p">])</span><span class="s"> </span><span class="p">::</span><span class="s"> &quot;LG(cols </span><span class="p">\(</span><span class="nv">j</span><span class="p">)</span><span class="s"> </span><span class="p">\(</span><span class="nv">j</span><span class="o">+</span><span class="m">1</span><span class="p">)</span><span class="s">)&quot;</span>
<span class="s">        </span><span class="p">);</span><span class="s"></span>

<span class="k">solve</span><span class="s"> </span><span class="k">satisfy</span><span class="p">;</span><span class="s"></span>

<span class="k">output</span><span class="s"> </span><span class="p">[</span><span class="s"> </span><span class="nf">show2d</span><span class="p">(</span><span class="nv">X</span><span class="p">)</span><span class="s"> </span><span class="p">];</span><span class="s"></span>
</pre></div>
</div>
</div>
<p>Here we have used the new constraint and expression annotations
added in MiniZinc 2.2.0. Note that these annotations are not
necessary for FindMUS to work but may help with interpreting the
output. The first two constraints: <tt class="docutils literal">ADRows</tt> and <tt class="docutils literal">ADCols</tt> define the
<tt class="docutils literal">alldifferent</tt> constraints on the respective rows and columns of the
latin square. The next two constraints <tt class="docutils literal">LLRows</tt> and <tt class="docutils literal">LGCols</tt> post
<tt class="docutils literal">lex</tt> constraints that order the rows to be increasing and the columns
to be increasing. Certain combinations of these constraints are going
to be in conflict.</p>
<p>Executing the command <tt class="docutils literal">findMUS -n 2 latin_squares.mzn</tt>
returns the following output. Note that the <tt class="docutils literal">-n 2</tt> argument requests
that just the first two MUSes are found.</p>
<div class="highlight-minizincdef notranslate"><div class="highlight"><pre><span></span><span class="nv">FznSubProblem</span><span class="p">:</span><span class="s">  </span><span class="nv">hard</span><span class="s"> </span><span class="nv">cons</span><span class="p">:</span><span class="s"> </span><span class="m">0</span><span class="s">    </span><span class="nv">soft</span><span class="s"> </span><span class="nv">cons</span><span class="p">:</span><span class="s"> </span><span class="m">10</span><span class="s">   </span><span class="nv">leaves</span><span class="p">:</span><span class="s"> </span><span class="m">10</span><span class="s">      </span><span class="nv">branches</span><span class="p">:</span><span class="s"> </span><span class="m">11</span><span class="s">    </span><span class="nv">Built</span><span class="s"> </span><span class="bp">tree</span><span class="s"> </span><span class="k">in</span><span class="s"> </span><span class="m">0.02854</span><span class="s"> </span><span class="nv">seconds</span><span class="s">.</span>
<span class="nv">MUS</span><span class="p">:</span><span class="s"> </span><span class="m">7 3</span><span class="s"> </span><span class="m">6 4</span><span class="s"> </span><span class="m">8</span><span class="s"></span>
<span class="nv">Brief</span><span class="p">:</span><span class="s"> </span><span class="nv">gecode_all_different_int</span><span class="p">;</span>@{ADCols@<span class="nf">AD</span><span class="p">(</span><span class="nv">col</span><span class="s"> </span><span class="m">1</span><span class="p">)</span><span class="gr">}</span><span class="p">:(</span><span class="nv">j</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="s"></span>
<span class="nv">gecode_all_different_int</span><span class="p">;</span>@{ADCols@<span class="nf">AD</span><span class="p">(</span><span class="nv">col</span><span class="s"> </span><span class="m">2</span><span class="p">)</span><span class="gr">}</span><span class="p">:(</span><span class="nv">j</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="s"></span>
<span class="nv">gecode_array_int_lt</span><span class="p">;</span>@{LGCols@<span class="nf">LG</span><span class="p">(</span><span class="nv">cols</span><span class="s"> </span><span class="m">1 2</span><span class="p">)</span><span class="gr">}</span><span class="p">:(</span><span class="nv">j</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="s"></span>
<span class="nv">gecode_array_int_lt</span><span class="p">;</span>@{LLRows@<span class="nf">LL</span><span class="p">(</span><span class="nv">rows</span><span class="s"> </span><span class="m">1 2</span><span class="p">)</span><span class="gr">}</span><span class="p">:(</span><span class="nv">i</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="s"></span>
<span class="nv">gecode_array_int_lt</span><span class="p">;</span>@{LLRows@<span class="nf">LL</span><span class="p">(</span><span class="nv">rows</span><span class="s"> </span><span class="m">2 3</span><span class="p">)</span><span class="gr">}</span><span class="p">:(</span><span class="nv">i</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="s"></span>

<span class="nv">Traces</span><span class="p">:</span><span class="s"></span>
<span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|5</span><span class="gr">|</span><span class="m">20|9</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="k">forall</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|5</span><span class="gr">|</span><span class="m">20|9</span><span class="gr">|</span><span class="nv">ac</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|13</span><span class="gr">|</span><span class="m">18|13</span><span class="gr">|</span><span class="nv">i</span><span class="o">=</span><span class="m">2</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">19|10</span><span class="gr">|</span><span class="m">19|37</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="bp">lex_less</span><span class="s"></span>
<span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|5</span><span class="gr">|</span><span class="m">15|9</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="k">forall</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|5</span><span class="gr">|</span><span class="m">15|9</span><span class="gr">|</span><span class="nv">ac</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|13</span><span class="gr">|</span><span class="m">13|13</span><span class="gr">|</span><span class="nv">j</span><span class="o">=</span><span class="m">1</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">14|10</span><span class="gr">|</span><span class="m">14|30</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="nv">alldifferent</span><span class="s"></span>
<span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|5</span><span class="gr">|</span><span class="m">20|9</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="k">forall</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|5</span><span class="gr">|</span><span class="m">20|9</span><span class="gr">|</span><span class="nv">ac</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|13</span><span class="gr">|</span><span class="m">18|13</span><span class="gr">|</span><span class="nv">i</span><span class="o">=</span><span class="m">1</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">19|10</span><span class="gr">|</span><span class="m">19|37</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="bp">lex_less</span><span class="s"></span>
<span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|5</span><span class="gr">|</span><span class="m">15|9</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="k">forall</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|5</span><span class="gr">|</span><span class="m">15|9</span><span class="gr">|</span><span class="nv">ac</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|13</span><span class="gr">|</span><span class="m">13|13</span><span class="gr">|</span><span class="nv">j</span><span class="o">=</span><span class="m">2</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">14|10</span><span class="gr">|</span><span class="m">14|30</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="nv">alldifferent</span><span class="s"></span>
<span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">22|5</span><span class="gr">|</span><span class="m">24|9</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="k">forall</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">22|5</span><span class="gr">|</span><span class="m">24|9</span><span class="gr">|</span><span class="nv">ac</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">22|13</span><span class="gr">|</span><span class="m">22|13</span><span class="gr">|</span><span class="nv">j</span><span class="o">=</span><span class="m">1</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">23|10</span><span class="gr">|</span><span class="m">23|40</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="bp">lex_greater</span><span class="s"></span>

<span class="nv">MUS</span><span class="p">:</span><span class="s"> </span><span class="m">7 3</span><span class="s"> </span><span class="m">5 6</span><span class="s"> </span><span class="m">8 9</span><span class="s"></span>
<span class="nv">Brief</span><span class="p">:</span><span class="s"> </span><span class="nv">gecode_all_different_int</span><span class="p">;</span>@{ADCols@<span class="nf">AD</span><span class="p">(</span><span class="nv">col</span><span class="s"> </span><span class="m">1</span><span class="p">)</span><span class="gr">}</span><span class="p">:(</span><span class="nv">j</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="s"></span>
<span class="nv">gecode_all_different_int</span><span class="p">;</span>@{ADCols@<span class="nf">AD</span><span class="p">(</span><span class="nv">col</span><span class="s"> </span><span class="m">3</span><span class="p">)</span><span class="gr">}</span><span class="p">:(</span><span class="nv">j</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="s"></span>
<span class="nv">gecode_array_int_lt</span><span class="p">;</span>@{LGCols@<span class="nf">LG</span><span class="p">(</span><span class="nv">cols</span><span class="s"> </span><span class="m">1 2</span><span class="p">)</span><span class="gr">}</span><span class="p">:(</span><span class="nv">j</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="s"></span>
<span class="nv">gecode_array_int_lt</span><span class="p">;</span>@{LGCols@<span class="nf">LG</span><span class="p">(</span><span class="nv">cols</span><span class="s"> </span><span class="m">2 3</span><span class="p">)</span><span class="gr">}</span><span class="p">:(</span><span class="nv">j</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="s"></span>
<span class="nv">gecode_array_int_lt</span><span class="p">;</span>@{LLRows@<span class="nf">LL</span><span class="p">(</span><span class="nv">rows</span><span class="s"> </span><span class="m">1 2</span><span class="p">)</span><span class="gr">}</span><span class="p">:(</span><span class="nv">i</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="s"></span>
<span class="nv">gecode_array_int_lt</span><span class="p">;</span>@{LLRows@<span class="nf">LL</span><span class="p">(</span><span class="nv">rows</span><span class="s"> </span><span class="m">2 3</span><span class="p">)</span><span class="gr">}</span><span class="p">:(</span><span class="nv">i</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="s"></span>

<span class="nv">Traces</span><span class="p">:</span><span class="s"></span>
<span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|5</span><span class="gr">|</span><span class="m">20|9</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="k">forall</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|5</span><span class="gr">|</span><span class="m">20|9</span><span class="gr">|</span><span class="nv">ac</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|13</span><span class="gr">|</span><span class="m">18|13</span><span class="gr">|</span><span class="nv">i</span><span class="o">=</span><span class="m">2</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">19|10</span><span class="gr">|</span><span class="m">19|37</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="bp">lex_less</span><span class="s"></span>
<span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|5</span><span class="gr">|</span><span class="m">15|9</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="k">forall</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|5</span><span class="gr">|</span><span class="m">15|9</span><span class="gr">|</span><span class="nv">ac</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|13</span><span class="gr">|</span><span class="m">13|13</span><span class="gr">|</span><span class="nv">j</span><span class="o">=</span><span class="m">1</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">14|10</span><span class="gr">|</span><span class="m">14|30</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="nv">alldifferent</span><span class="s"></span>
<span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|5</span><span class="gr">|</span><span class="m">15|9</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="k">forall</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|5</span><span class="gr">|</span><span class="m">15|9</span><span class="gr">|</span><span class="nv">ac</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">13|13</span><span class="gr">|</span><span class="m">13|13</span><span class="gr">|</span><span class="nv">j</span><span class="o">=</span><span class="m">3</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">14|10</span><span class="gr">|</span><span class="m">14|30</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="nv">alldifferent</span><span class="s"></span>
<span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|5</span><span class="gr">|</span><span class="m">20|9</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="k">forall</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|5</span><span class="gr">|</span><span class="m">20|9</span><span class="gr">|</span><span class="nv">ac</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">18|13</span><span class="gr">|</span><span class="m">18|13</span><span class="gr">|</span><span class="nv">i</span><span class="o">=</span><span class="m">1</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">19|10</span><span class="gr">|</span><span class="m">19|37</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="bp">lex_less</span><span class="s"></span>
<span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">22|5</span><span class="gr">|</span><span class="m">24|9</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="k">forall</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">22|5</span><span class="gr">|</span><span class="m">24|9</span><span class="gr">|</span><span class="nv">ac</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">22|13</span><span class="gr">|</span><span class="m">22|13</span><span class="gr">|</span><span class="nv">j</span><span class="o">=</span><span class="m">1</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">23|10</span><span class="gr">|</span><span class="m">23|40</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="bp">lex_greater</span><span class="s"></span>
<span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">22|5</span><span class="gr">|</span><span class="m">24|9</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="k">forall</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">22|5</span><span class="gr">|</span><span class="m">24|9</span><span class="gr">|</span><span class="nv">ac</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">22|13</span><span class="gr">|</span><span class="m">22|13</span><span class="gr">|</span><span class="nv">j</span><span class="o">=</span><span class="m">2</span><span class="p">;</span><span class="nv">latin_squares</span><span class="s">.</span><span class="nv">mzn</span><span class="gr">|</span><span class="m">23|10</span><span class="gr">|</span><span class="m">23|40</span><span class="gr">|</span><span class="nv">ca</span><span class="gr">|</span><span class="bp">lex_greater</span><span class="s"></span>
<span class="nv">Total</span><span class="s"> </span><span class="nv">Time</span><span class="p">:</span><span class="s"> </span><span class="m">0.39174</span><span class="s">     </span><span class="nv">nmuses</span><span class="p">:</span><span class="s"> </span><span class="m">2</span><span class="s">       </span><span class="nv">map</span><span class="p">:</span><span class="s">     </span><span class="m">40</span><span class="s">     </span><span class="nv">sat</span><span class="p">:</span><span class="s">     </span><span class="m">21</span><span class="s">     </span><span class="nv">total</span><span class="p">:</span><span class="s">     </span><span class="m">61</span><span class="s"></span>
</pre></div>
</div>
<p>The first line, starting with <tt class="docutils literal">FznSubProblem:</tt> provides some useful
information for debugging the <tt class="docutils literal">findMUS</tt> tool. Next we have the list of MUSes.
Each MUS is described with three sections:</p>
<blockquote>
<div><ol class="arabic simple">
<li><tt class="docutils literal">MUS:</tt> lists the indices of the FlatZinc constraints involved in
this MUS.</li>
<li><tt class="docutils literal">Brief:</tt> lists the FlatZinc constraint name, the
expression name, the constraint name, and the loop index assignments
for each involved FlatZinc constraint.</li>
<li><tt class="docutils literal">Traces:</tt> lists the MiniZinc paths corresponding to the constraints
of the MUS.
Each path typically contains a list of path elements separated by
semi-colons <tt class="docutils literal">;</tt>. Each element includes a file path, a start line,
start column, end line and end column denoting a span of text from
the listed file. And finally, a description of the element.
In the examples above all paths point to calls to a forall on
different lines of the model. (<tt class="docutils literal">ca|forall</tt>)</li>
</ol>
</div></blockquote>
<p>The final line of output lists the <tt class="docutils literal">Total Time</tt>, the number of MUSes
found, and some statistics about the number of times the internal map
solver <tt class="docutils literal">map</tt> was called, and the number of times the subproblem solver
was called <tt class="docutils literal">sat</tt>.</p>
<p>Interpreting these two MUSes we see that the <tt class="docutils literal">lex</tt> constraints are
incompatible with the <tt class="docutils literal">alldifferent</tt> constraints.</p>
</div>
</div>
<div class="section" id="using-findmus-in-the-minizinc-ide">
<h2>3.8.2. Using FindMUS in the MiniZinc IDE<a class="headerlink" href="#using-findmus-in-the-minizinc-ide" title="Permalink to this headline">¶</a></h2>
<p>To use FindMUS in the MiniZinc IDE, upon discovering that a model is
unsatisfiable. Select <tt class="docutils literal">FindMUS</tt> from the solver configuration dropdown
menu and click the solve button (play symbol).
This will look for MUSes using the default <tt class="docutils literal">--paramset mzn</tt> argument.</p>
<img alt="images/ide_depth_mzn.png" src="images/ide_depth_mzn.png" />
<p>In this case we can see that the output pane shows the constraints
involved in the MUS in terms of the expression annotations, grouped
by the constraint annotations. Clicking on the MUS in the output pane
will highlight the constraints in your model.</p>
<p>If finding MUSes with <tt class="docutils literal">--paramset mzn</tt> is prohibitively slow,
you can try running instead with <tt class="docutils literal">--paramset hint</tt>.
This merges many of the low level constraints into larger units
and should be relatively fast and help locate the relevant constraint
items.  The following shows the result:</p>
<img alt="images/ide_depth_1.png" src="images/ide_depth_1.png" />
<p>Selecting the returned MUS highlights three top level constraints as
shown: <tt class="docutils literal">ADRows</tt>, <tt class="docutils literal">LLRows</tt> and <tt class="docutils literal">LGCols</tt>.</p>
<p>Alternatively, in some cases you may wish to look at the MUSes of your
model in terms of the flattened FlatZinc program. To display these
MUSes run FindMUS with the <tt class="docutils literal">--paramset fzn</tt> argument.</p>
<img alt="images/ide_depth_fzn.png" src="images/ide_depth_fzn.png" />
<p>In this figure you can see that the MUSes are expressed in terms of
FlatZinc constraints along with any assignments to relevant loop variables.
Clicking on this MUS also opens and highlights the source of the constraints
in the MiniZinc library (in this case in Gecode’s custom redefinition of
<tt class="docutils literal">fzn_all_different_int</tt>.</p>
</div>
<div class="section" id="how-it-works">
<h2>3.8.3. How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<p>A simple explanation of the algorithm is presented here. For a more
detailed exploration of an earlier version of the approach see the
Debugging Unsatisfiable Constraint Models paper <a class="footnote-reference" href="#id6" id="id4">[1]</a>.</p>
<p>The approach takes the full FlatZinc program and partitions the constraints
into groups based on the hierarchy provided in the user’s model. To
begin with (at depth ‘1’) we search for MUSes in the set of top level
constraint items using the MARCO <a class="footnote-reference" href="#id8" id="id5">[3]</a> MUS enumeration algorithm. If we
are not at the target depth we recursively select a found MUS, split
its constituent constraints into lower level constraints based on the
hierarchy and begin another search for MUSes underneath this high-level
MUS. If any MUSes are found we know that the high-level MUS is not minimal
and so it should not be reported.  This process is repeated on any found
unsatisfiable subsets until we reach the required depth at which point
we will start to report MUSes. If in the recursive search we return to a
high-level MUS without finding any sub-MUSes we can report this MUS as
a real MUS. This recursive process is referred to as HierMUS. At each
stage when we request the enumeration of a set of MUSes underneath a
high-level MUS we can use one of several MUS enumeration algorithms.</p>
</div>
<div class="section" id="performance-tips">
<h2>3.8.4. Performance tips<a class="headerlink" href="#performance-tips" title="Permalink to this headline">¶</a></h2>
<p>If you are trying to find MUSes in a very large instance it is advised to
make use of the filtering tools available. Use the default settings to
find a very high-level MUS and then use the <tt class="docutils literal">--depth</tt> option to find
lower-level, more specific MUSes in conjunction with the <tt class="docutils literal">--filter-name</tt>
and <tt class="docutils literal">--filter-path</tt> options to focus on finding specific sub-MUSes of a
found high-level MUS.</p>
<p>When parameter tuning for FindMUS the oracle checker mode can speed up
testing of different sets of parameters.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Run <tt class="docutils literal">findMUS -a --paramset fzn --output-brief ... > muses.log</tt> to
save the output log to a file.</li>
<li>Run subsequent sets of parameters with
<tt class="docutils literal">findMUS -a --paramset fzn --output-brief --oracle-only muses.log ...</tt>.
The oracle mode will perform enumeration without making calls to the
sub-solver, instead deciding SAT/UNSAT based on the MUS log (omit
<tt class="docutils literal">--oracle-only</tt> to call the sub-solver when the status of a
subset is unknown)</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="limitations-future-work">
<h2>3.8.5. Limitations / Future work<a class="headerlink" href="#limitations-future-work" title="Permalink to this headline">¶</a></h2>
<p>There are several features that we aim to include quite soon:</p>
<blockquote>
<div><dl class="docutils">
<dt>Solver core/MUS/IIS integration</dt>
<dd>Set shrinking can be accelerated by using problem specific
MUS extraction methods that some solvers provide.</dd>
<dt>Context-find</dt>
<dd>Once a MUS has been found flip the foreground + background
and narrow down the parts of the background that complete
the MUS</dd>
<dt>Regular expression based filtering</dt>
<dd>This will allow more complex filtering to be used.</dd>
<dt>Text span based filtering</dt>
<dd>This will allow a user to simply click-and-drag a selection around the
parts of a constraint model they wish to analyse.</dd>
</dl>
</div></blockquote>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> Leo, K. et al., “Debugging Unsatisfiable Constraint Models”, 2017.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td><a class="reference external" href="https://en.wikipedia.org/wiki/Latin_square">https://en.wikipedia.org/wiki/Latin_square</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[3]</a></td><td>Liffiton, M. H. et al., “Fast, Flexible MUS Enumeration”, 2016.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[4]</a></td><td>Junker, U. et al., “QUICKXPLAIN: preferred explanations and relaxations for over-constrained problems”, 2004.</td></tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="jupyter.html" class="btn btn-neutral float-right" title="3.9. Using MiniZinc in Jupyter Notebooks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="globalizer.html" class="btn btn-neutral" title="3.7. Globalizer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, 2017, 2018, 2019, 2020 Peter J. Stuckey, Kim Marriott, Guido Tack.

    </p>
  </div>
<a rel="license" href="http://creativecommons.org/licenses/by-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nd/4.0/80x15.png" /></a>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.7.3',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>
      <script type="text/javascript" src="static/js/doc-links.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>